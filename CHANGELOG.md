# 【哈希值批量计算器】更新日志

## 版本：v5.13.0，2024/1/5

1. 给【筛选与操作】面板添加一个用于指示正在筛选中的动态图标

## 版本：v5.12.1，2024/1/5

1. ShellExtensions(外壳扩展模块)改为静态编译以解决在某些系统上缺少依赖库的问题

## 版本：v5.12.0，2024/1/4

1. 安装外壳扩展模块时，如果不存在快捷菜单配置文件则使用默认配置创建配置文件
2. 快捷菜单配置文件编辑器现在加载和保存 UTF-16LE 编码版本的快捷菜单配置文件
3. 外壳扩展模块现在按照 UTF-16LE 编码版本的快捷菜单配置文件【menus_unicode.json】生成快捷菜单，避免修改系统编码后快捷菜单出现乱码
4. 修复移除某一行后点击【新增哈希计算】按钮，已被移除的行再次出现的问题
5. 【显示设置】中增加设置项【显示主窗口按钮的名称】并实现其功能 (默认打开)
6. 【复制模板设置】页更名为【复制行为设置】，增加设置项【复制的内容含算法名时算法名的大小写跟随十六进制输出方式】并实现功能 (默认关闭)

## 版本：v5.11.1，2023/12/31

1. 修复不显示【输出方式】列后再重新显示，输出方式列中的复选框变为未选中状态的问题

## 版本：v5.11.0，2023/12/31

1. 添加“不显示【输出方式】列”设置项
2. 删除重复记录的设置项，更新部分小图标，删除未使用的资源
3. 主窗口【哈希值】列中增加一个按钮用于复制对应行的所有结果
4. 【常规设置】页增加设置项【校验时自动把算法切换到】并实现功能
5. 设置面板中增加【复制模板设置】页，实现按模板复制哈希值功能
6. 修复把只包含哈希值的文件当作校验依据打开时获取到空文件名导致异常退出的问题

## 版本：v5.10.2，2023/12/24

1. 快捷菜单编辑器保存配置时不再限制为必须同时拥有两种类型的菜单
2. 修复使用快捷菜单配置编辑器编辑子菜单时，如果子菜单列表为空，点击“上/下移动”按钮或“移除”按钮会导致异常退出的问题

## 版本：v5.10.1，2023/12/22

1. 删除外壳扩展模块内未使用的资源，修正快捷菜单图标有白边的问题，优化菜单构建逻辑
2. 更改部分设置项的文案以期望设置项的作用能被描述得更清楚
3. 增加常规设置的【哈希值计算任务设置】组中两个设置项的互斥逻辑，避免设置不当导致可能发生程序无响应的情况
4. 删除默认哈希算法面板的部分提示

## 版本：v5.10.0，2023/12/19

1. **实现系统右键快捷菜单的自定义集成功能，方便自行决定集成到系统右键的快捷菜单**
2. 更换 SHA224 和 Whirlpool 算法的实现库，Whirlpool 算法耗时相较于上一个版本减少约 25%
3. 添加 eD2k 算法、MD4 算法、RipeMD160 算法和 Has160 算法
4. 解决误使用体积很大的非文本文件作为校验依据文件时长时间无法完成文件读取的问题
5. 安装外壳扩展时不再将 HashCalculator.dll 释放到当前位置，也不再限制主程序文件名为 HashCalculator.exe
6. 给设置面板的“快捷菜单与文件关联”页添加“修复程序路径”内部链接
7. 安装系统外壳扩展的注册表更改逻辑集成到 HashCalculator.dll 内，解决之前版本卸载外壳扩展时注册表可能清理不干净的问题
8. 修正之前设置文件的默认打开程序为 HashCalculator 时程序名称和图标可能显示不正确的问题

#### 命令行参数方面的更改：

1. verify 子命令 -b/--basis 改为 -l/--list
2. 命令行 -a/algo 选项的参数：XXHASH32→XXH32, XXHASH64→XXH64, XXHASH3→XXH3_64, XXHASH128→XXH3_128
3. 命令行 -a/algo 选项的参数：SHA1→SHA_1, SHA224→SHA_224...

## 版本：v5.9.0，2023/11/28

1. 修改部分主窗口右键菜单文字，删除多余的菜单项
2. 主窗口哈希值后面的“详情”按钮改为显示该行已计算的算法数量（仍然保留原点击功能）
3. 给设置项“直接使用校验依据进行校验时首选依据算法而非默认算法”添加子项“当校验依据中未指明算法时”并实现相关功能
4. 用命令行参数启动校验流程的命令【hashcalculator.exe verify -b path_to_checklist_file】现在增加对可选参数【-a/--algo】的支持，此参数用于指定首选算法
5. 给系统右键菜单“作为哈希校验依据打开”添加算法子菜单，可以选择使用指定的算法来计算，其中“自动选择”子菜单行为与原行为相同
6. 修复当哈希值校验依据文件路径中有空格时从系统右键菜单启动校验没有反应的问题
7. 系统右键菜单选项“计算所选对象哈希值”和“执行指定哈希算法”合并为“计算所选对象的哈希值”，其中子选项“默认算法”与原“计算所选对象哈希值”行为一致
8. 对设置面板“常规设置”页的相关联的设置项进行分组
9. 主窗口的“文件大小”列改为显示直观的文件大小（以不同的单位显示）
10. 添加国密 SM3 算法
11. 系统右键相关菜单中增加 SM3 算法子项
12. 设置面板增加设置项“复制的字符数在此范围内时才触发”并实现其功能

## 版本：v5.8.0，2023/11/23

1. 修改主窗口的哈希值校验依据输入框提示文案
2. 更新更清晰的图标：程序图标、系统右键扩展菜单图标、.hcb 文件图标（其中系统右键扩展菜单图标和 .hcb 文件图标需要在旧版本 HashCalculator 卸载右键扩展菜单后再在新版本安装右键扩展菜单才能体现效果）

## 版本：v5.7.0，2023/11/21

1. 将 blake3.dll 和 xxhash.dll 删除，hashalg.dll 中增加 blake3 和 xxhash 算法实现，进一步减小软件大小
2. 文件哈希值详情窗口的哈希值列表改为使用表格展示
3. 为避免在主窗口更改“导出”属性需要逐个哈希值切换的麻烦，在文件哈希值详情窗口增加了“导出”列
4. 添加监控剪贴板功能，如果复制了新的哈希值，则用此值填充”哈希值或文件路径“文本框，如果此时非正在运行状态则立即进行校验
5. 增加设置项“剪贴板中有新复制的哈希值时填充校验依据文本框并校验”
6. 设置面板增加设置项“用剪贴板哈希填充校验依据文本框并校验后把主窗带到前台”并实现功能
7. 主窗口的“校验依据”输入框支持粘贴/输入多行内容
8. 哈希校验依据输入框支持输入与导出的哈希结果文件一样的内容
9. 校验依据和命令行参数中的哈希算法名不再区分大小写
10. 修复某些情况下通过系统右键菜单计算文件哈希值或双击打开.hcb文件无法将已存在的HashCalculator主窗口带到前台的问题
11. 修复主窗口“哈希值校验依据”输入框混合输入单独的哈希值、哈希值+文件名、算法名+哈希值+文件名有可能会导致校验结果全部是“不确定”的问题
12. 原“哈希值”筛选器在用户输入错误的哈希值时所有文件都可以通过筛选，现在改为所有文件都不可以通过筛选
13. 删除算法选择面板的 Blake2b、Blake2bp、Blake2s、Blake2sp、Blake3 算法的 128/160 位版本
14. 将默认哈希值面板中的 SHA3 系列算法从 SHA 分组中拆分出来作为单独的一组
15. 修复短时间快速点击复制哈希值按钮大概率会导致软件异常退出的问题：复制哈希值失败时增加提示窗口，而不是发生异常退出程序
16. 为避免在文件哈希值详情窗口复制哈希值时触发剪贴板监控，哈希值详情窗口的哈希值改为不可选择，增加“复制”按钮用于复制哈希值
17. 更新“刷新输出方式”按钮图标并移到“默认输出方式”下拉列表后面
18. 修正主窗口标题在 Windows 10 和在 Windows 11 上显示不一致的问题

## 版本：v5.6.0，2023/10/26

1. Crc32 算法改为使用 C 实现，速度提升近一倍
2. 添加 Crc64 算法
3. 部分算法所需的外部动态链接库合并为一个，减小文件体积
4. 系统右键菜单“执行指定的哈希算法”增加 Crc64 选项（请在旧版本卸载右键菜单后打开新版本重新安装右键菜单）

## 版本：v5.5.0，2023/10/24

1. 对部分算法计算速度缓慢的问题进行优化 (改用 C 实现)，在没有硬盘读取速度瓶颈的情况下，计算速度大幅提升：
    - 计算 `SHA3` 耗时是 5.4 版本的 70%
    - 计算 `SHA224` 耗时是 5.4 版本的 33%
    - 计算 `Blake2s` 耗时是 5.4 版本的 12%
    - 计算 `Blake2b` 耗时是 5.4 版本的 18%
    - 计算 `Blake3` 耗时是 5.4 版本的 4%
    - 计算 `Whirlpool` 耗时是 5.4 版本的 11%
    - 其他在以上两点未提及的算法都是速度正常或新增的算法
2. 增加两个筛选器：【文件大小】和【相同文件夹】筛选器
3. 筛选与操作面板布局更改，筛选器改为使用列表显示
4. 删除文件】和【重命名文件】操作增加未使用【有效文件】筛选器时的提示
5. 有效的文件】筛选器默认勾选
6. 筛选与操作面板改为可手动调整大小
7. 修复在使用【相同哈希值】筛选器时，如果存在大量相同哈希值的文件组，则不同的哈希值可能会被分为同一组的问题
8. 增加算法支持：QuickXor、Blake2bp、Blake2sp、Streebog。
9. 删除 BouncyCastle.Cryptography.dll 依赖，减小可执行文件体积
10. 系统右键菜单“执行指定哈希算法”增加 QuickXor、Blake2sp-256、Blake2bp-512、Streebog-256 选项
11. 修改“默认哈希算法”面板，对算法进行分类以缓解算法太多太杂乱的问题
12. 设置面板的“常见问题修复向导”页添加若干修复项
13. 哈希值详情窗口由自动调整大小改为可手动调整大小，以免选择的算法太多时窗口超出屏幕范围
14. 重新排列系统右键菜单的“执行指定的哈希算法”的子选项以使其与主程序算法排序相同
15. 更新系统右键菜单的“执行指定的哈希算法”的部分子选项以使其与主程序算法名称相同

## 版本：v5.4.0，2023/10/3

1. xxhash 算法由使用 C# 的实现改为使用 C 库的实现，在没有硬盘读取速度瓶颈时计算速度有大幅度提升
2. 增加两个 XxHash 算法：XXH3 和 XXH128，同时原 Xxhash32 和 XxHash64 算法分别更名为 XXH32 和 XXH64 以符合官方命名
3. 设置面板增加【常见问题修复向导】页
4. 设置面板增加设置项【不要计算空文件的哈希值以避免造成文件内容相同的误导】
5. 引入 System.Buffers.dll，用于读取文件的缓冲区改为从 ArrayPool 租借，提高计算大量小文件时的性能
6. 设置文件中记录已勾选的默认哈希算法方式更改，新版 HashCalculator 需要重新勾选默认哈希算法


## 版本：v5.3.0，2023/9/29

1. 修复哈希值非常短导致哈希值末尾与【详情】按钮直接有空白的情况下，双击空白处打不开详情面板的问题
2. 删除 Crc32C 算法，增加 XxHash32 算法和 XxHash64 算法
3. 系统右键菜单【执行指定哈希算法】增加子项【XxHash32】和【XxHash64】
4. 主窗口表格右键菜单增加【批量切换算法】选项，更改部分选项名称


## 版本：v5.2.0，2023/9/28

1. 新增 Crc32 和 Crc32C 算法
2. 系统右键菜单【执行指定哈希算法】增加子项【Crc32】


## 版本：v5.1.0，2023/9/26

1. 实现一次任务同时计算多个算法的结果，每个任务成功后显示一个详情按钮，点击打开详情窗口
2. 实现通过哈希校验依据文件进行校验时同时校验多个算法的哈希值
3. 设置面板增加设置项“直接使用校验依据进行校验时首选校验依据中的算法而非默认算法”并实现从校验依据文件解析对应文件的对应算法并进行计算
4. 调整设置面板分类
5. 增加设置项“导出哈希值时导出哪些算法的结果”并实现相关功能
6. 哈希结果列表增加两个右键菜单选项：复制所有算法结果、按格式复制所有算法结果
7. 文件大小列的悬浮提示使用合适的单位显示直观的文件大小
8. 算法面板和文件详情面板增加按 ESC 键关闭功能
9. 修复使用文本文件校验依据直接校验时，没有搜索到的文件名在表格中总是显示为小写字母的问题
10. 增加设置项“每个任务的多个算法并行”并实现功能
11. 增加筛选面板，用于筛选计算结果表格内容 (#21)，其中包含一些筛选器和一些可对筛选结果执行的命令，组合使用可实现筛选并删除多余的相同哈希值文件功能 (#17)
12. 修正系统右键菜单“执行指定的哈希算法”部分选项失效的问题 (#23)
13. 修复通过哈希表格右键菜单打开单个文件位置且文件不存在时，错误打开并选中文件所在目录的问题
14. 主窗口右上角的【帮助】按钮改为【关于】按钮，由“使用浏览器打开本地帮助页面”改为打开包含相关链接的【关于】窗口


## 版本：v4.5.1，2023/8/6

1. 修复某些情况下因注册表父键不存在而导致安装右键菜单失败的问题
2. 使用无效的校验依据文件时不再提示用户选择处理方式，而是中断校验并提示可能的失败原因
3. 其他 UI 细节调整


## 版本：v4.5.0，2023/7/23

1. 导出哈希结果的保存文件窗口增加[HashCalculator 校验依据|*.hcb]文件类型
2. 修正从命令行启动 HashCalculator 时没有输入正确的子命令仍然会开始计算的问题
3. 增加与 .hcb 文件的关联功能，打开/删除关联的方式附加在”安装/卸载右键菜单“按钮上
4. 修复“从系统右键菜单以指定的算法启动计算，任务完成后点击[新增哈希计算]没有使用默认的哈希算法新增计算，而是以原指定算法进行计算”的问题
5. 重构设置面板，增加设置项：导出哈希计算结果时首选导出文件类型
6. 系统右键菜单增加选项"作为哈希校验依据打开"，对单个文件右击时右键菜单会出现此选项 (#5)
7. 更新 BouncyCastle.Cryptography.dll 版本到 2.2.1


## 版本：v4.4.0，2023/7/13

1. 设置面板增加两个按钮：安装/卸载右键菜单，实现非安装版 HashCalculator 的右键菜单安装、卸载功能
2. 增加设置项，可以选择是否允许运行多个程序实例，从系统右键菜单启动计算时会根据设置决定启动新窗口还是在原窗口进行计算
3. 删除设置面板一些无用的设置（程序未使用的设置）
4. 从系统右键菜单或命令行启动计算，会把承担计算任务的窗口切换到前台
5. 主窗口关闭时自动记住窗口最大最小化状态（请注意：在最小化状态下关闭，下次启动仍是最小化状态）


## 版本：v4.3.0，2023/7/8

1. 安装版的 HashCalculator 集成了自己的两个菜单选项到系统右键菜单，现在可以通过在文件、文件夹、文件夹背景、混选的文件和文件夹上点击右键，选择“计算所选对象哈希值”或“执行指定的哈希算法”来打开 HashCalculator 计算所选对象的哈希值
2. 右键菜单增加“复制文件名”选项
3. 增加程序内右键菜单选项：任务控制，可对多选的任务进行继续、暂停、取消、新增计算、启动未成功项、重新计算操作
4. “文件名”列和“哈希值”列的悬浮提示弹出策略由立即弹出改为系统默认值以减少鼠标在表格上移动时受到的信息干扰
5. “本次待计算队列中的项目总数”和“本次待计算队列已完成的项目数”图标合并为“剩余哈希计算任务数”使其更符合实际状态
6. 解决在正在计算多个文件哈希值过程中更改同时进行计算的任务数可能不能及时生效的问题
7. “文件体积”列的字节数由计算完成后显示改为在开始计算时显示
8. 解决右键菜单“删除文件”、“移除所选项”后不更新校验报告的问题
9. 主界面增加新按钮“停止搜索文件”，实现正在搜索文件同时正在计算过程中点击按钮停止搜索的功能
10. 增加主界面图片按钮的被点击时的效果
11. 优化添加大量文件时的调度逻辑，提高 UI 流畅度
12. 为主窗口图标按钮区域增加滚动条，当横向空间不足时自动显示滚动条
13. 右键菜单选项的可用状态不再绑定表格项数
14. 修复进行“重新计算”等操作时如果文件不存在也不更新“导出”列、“文件体积”列的问题
15. 主窗口左下角添加转圈圈动画，有计算任务时显示，否则不显示
16. 解决使用快速校验时，如果有大量找不到的文件且未完成搜索，点击“停止搜索”按钮无法成功停止的问题
17. 主界面的“继续”、“暂停”、“取消”三个图标按钮不再根据是否有任务运行而切换启用/禁用状态
18. 计算过程中“清空所有内容”按钮不再禁用，计算过程中点击清空按钮会先取消所有任务再清空表格
19. 修复点击取消全部任务时，计算失败/未找到的文件也被错误标记为“已取消”的问题
20. 调整主窗口图标按钮顺序，分组更合理。更新“清空所有内容”按钮图标，使图标更接近“清空”含义而不是之前的“删除”含义


## 版本：v4.1.0，2023/6/18

1. 添加算法选项：SHA3 系列、BLAKE2s(256bit)、BLAKE2b(512bit)、BLAKE3(256bit)、Whirlpool
2. 导出哈希值文本格式更改：每行前增加算法名称，如：`#SHA-1 *hash-string *file-name`
3. 校验依据文件读取逻辑更新：同时支持旧版和新版导出格式的文件
    - 旧版依据文件行格式：hash-string *file-name
    - 新版依据文件行格式：#SHA-1 *hash-string *file-name


## 版本：v4.0.0，2023/6/16

1. 添加 "输出方式" 下拉框; 在 Grid 中添加 "文件体积" 列; 删除设置界面的 "大小写" 设置 [@lujiaxing](https://github.com/lujiaxing)
2. 优化“导出”列的复选框总是需要点击两次才能更改选中状态的问题
3. 更新行内控制按钮的样式等细节
4. 主界面文字按钮改为图片按钮，使界面更简洁紧凑
5. 添加行右键菜单：打开文件、打开位置、复制路径、复制哈希结果、删除文件、移除所选项、文件属性
6. 更新程序图标
7. “哈希值”列、输出方式列、校验结果列改为允许点击表头排序
8. 可能解决了取消任务时偶尔出现完成任务数多于总数导致部分主按钮一直不可用的问题
9. 解决下拉列表框有时候文字模糊的问题
10. 主窗口增加显示：列表项目总数、待计算队列总数、待计算队列已完成数
11. 更改“增加新行重新计算列表文件哈希值”按钮的动作逻辑，使其真正地只重新计算已显示在列表中文件的哈希值，而不是已选择、已拖放的所有文件（包括还未显 示就被取消的文件）
12. 更改文件搜索逻辑，不再搜索完再显示文件，而是边搜索边显示文件，提升在选择/拖入大量文件时的 UI 流畅度
13. 改进逻辑以使更改哈希值输出类型时不再需要重新计算哈希值，校验哈希值时校验结果也不受输出方式的影响
14. 每行的"算法"改为在单独列显示
15. 增加“刷新输出方式”按钮、“计算所有未完成项”按钮
16. 表格改为支持选中多行
17. 更改表格鼠标悬浮时的背景色和选中时的背景色便于区分
18. 删除“使用帮助”窗口，点击“使用帮助”按钮使用默认浏览器打开使用帮助页面
19. 设置面板增加“右键选择删除文件时永久删除而不是移动到回收站”设置项
20. 删除“校验依据类型”下拉列表，"哈希值校验依据"输入框增加 PlaceHolder 类型的提示字符


## 版本：v2.0.1，2022/10/04

1. 更正帮助文档中的错误链接。


## 版本：v2.0.0，2022/10/04

1. 添加选择文件夹按钮：供不方便拖放文件的情况下使用。
2. 新增设置项“使用快速校验时”：可以设置在依据所在目录内搜索一代子文件还是全部子文件。
3. 新增菜单按钮：帮助按钮。点击打开帮助窗口以查看帮助文档。
4. 新增取消任务按钮：选错文件或者不想计算剩余文件的哈希值，可以直接点击取消所有任务。
5. 增加校验报告功能：完成哈希值计算或校验后，把鼠标悬停在任一行的“校验”结果列上就可以看到所有校验结果的汇总。
6. 主界面窗口微调，按钮和菜单不再紧贴标题栏。
7. 修复搜索子目录可能无法搜索到所有文件的问题。
8. 修复使用快速校验时，校验依据里存在但本地不存在的文件没有显示到表格里的问题。
9. 重构程序启动入口，将动态库打包进可执行文件以实现单文件运行。
10. 修复在点击取消任务时有可能使程序卡死的问题。
11. 修复使用快速校验时不同子目录下有相同文件名文件，只能显示其中之一的问题。
12. 修复使用快速校验时依据文件内有相同文件名会得到红色校验结果的问题，现在校验结果显示为黑色，代表`不确定`。
13. 其他未记录的 BUG 修复


## 版本：v1.5.0，2022/09/24

1. 修复问题：当面板中有条目时，使用“选择文件”按钮添加文件，会重复计算已存在的条目。
2. 修复拖放文件到面板但还未计算时哈希类型显示为 SHA256 的问题。
3. 增加记住主窗口关闭时的位置设置项。
4. 增加同时进行的任务数量上限设置项。
5. 新增功能：如果面板为空且校验依据是通用格式的哈希值文件(注1)，可以直接点击校验而无需事先把文件拖入面板计算哈希值。点击校验后程序会在哈希值文件所在目录寻找相应文件计算哈希值并显示校验结果。
6. 设置窗口可调整大小，关闭时自动记住窗口大小。

因设置文件变更，所以之前版本的设置文件可能失效，需要重新设置并保存。

注1：通用格式的哈希值文本文件指的是一个多行文本文件，无需特定后缀，但需要是 UTF-8 编码，每行的格式是：[哈希值][空格][可选星号][文件名]，具体请参考程序的“导出结果”功能导出的哈希值文本格式。


## 版本：v1.3.1，2022/08/24

1. 新增设置项：计算所得哈希值使用小写字母形式
2. 增加设置项：当拖入面板的对象包含文件夹时，可选项：搜索一代子文件、搜索全部子文件、不搜索该文件夹
3. 增加功能：鼠标悬浮在面板行上时显示相应文件的完整路径的悬浮提示


## 版本：v1.2.1，2022/08/18

1. 计算哈希值时，如果无法完成计算，则该行的“导出”列不再默认勾选。


## 版本：v1.2.0，2022/08/14

1. 新增主窗口置顶功能，方便在各种窗口之上对比哈希值
2. 新增 MD5、SHA1、SHA224、SHA384、SHA512哈希算法
3. 新增`主窗口关闭时保存窗口尺寸`设置项
4. 新增面`复制重算`按钮和`原地重算`按钮，分别对应的功能：
    - 以已拖入面板中的文件为文件来源，以`算法`下拉框所选哈希算法，新增相应的行数并计算哈希值
    - 以已拖入面板中的文件为文件来源，以`算法`下拉框所选哈希算法，重新计算哈希值并刷新面板中的结果
5. 检验文件计算所得哈希值时，没有检验过的行的`检验结果`列下的单元格背景色显示为白色，已检验但与依据没有关联则显示为`灰色`，方便区分该行是否已经检验


## 版本：v1.0.3，2022/08/05

1. 首个版本发布，支持SHA256哈希值的批量计算与检验。
